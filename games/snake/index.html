<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>NEON SNAKE</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">

<style>
body{
  margin:0;
  background:black;
  color:#00ffff;
  font-family:'Press Start 2P',cursive;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
  overflow:hidden;
  flex-direction:column;
}

canvas{
  background:#050510;
  box-shadow:0 0 40px #00ffff40;
  border:3px solid #00ffff;
}

.top{
  position:fixed;
  top:15px;
  left:20px;
  font-size:12px;
}

.back{
  position:fixed;
  top:15px;
  right:20px;
  font-size:12px;
  color:#00ffff;
  text-decoration:none;
  opacity:.7;
}

.overlay{
  position:fixed;
  inset:0;
  display:flex;
  justify-content:center;
  align-items:center;
  background:rgba(0,0,0,.8);
  flex-direction:column;
  font-size:18px;
  display:none;
}

button{
  margin-top:20px;
  padding:15px 25px;
  font-family:'Press Start 2P';
  background:#ff00ff;
  border:none;
  color:black;
  cursor:pointer;
}
</style>
</head>

<body>

<div class="top">SCORE: <span id="score">0</span></div>
<a href="../../index.html" class="back">EXIT</a>

<canvas id="game" width="320" height="320"></canvas>

<div class="overlay" id="over">
  <div>GAME OVER</div>
  <div id="final" style="font-size:14px;margin-top:10px"></div>
  <button onclick="restart()">RETRY</button>
</div>

<script>
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");

let size=16;
let snake=[{x:10,y:10}];
let dir={x:1,y:0};
let food=randomFood();
let score=0;
let speed=120;
let running=true;

function randomFood(){
  return {
    x:Math.floor(Math.random()*20),
    y:Math.floor(Math.random()*20)
  };
}

function draw(){
  ctx.fillStyle="#050510";
  ctx.fillRect(0,0,canvas.width,canvas.height);

  // food
  ctx.fillStyle="#ff00ff";
  ctx.shadowBlur=15;
  ctx.shadowColor="#ff00ff";
  ctx.fillRect(food.x*size,food.y*size,size,size);

  // snake
  ctx.fillStyle="#00ffff";
  ctx.shadowBlur=15;
  ctx.shadowColor="#00ffff";

  snake.forEach(s=>{
    ctx.fillRect(s.x*size,s.y*size,size,size);
  });
}

function update(){
  if(!running) return;

  const head={
    x:snake[0].x+dir.x,
    y:snake[0].y+dir.y
  };

  // wall
  if(head.x<0||head.y<0||head.x>=20||head.y>=20){
    gameOver();return;
  }

  // self hit
  for(let s of snake){
    if(s.x===head.x && s.y===head.y){
      gameOver();return;
    }
  }

  snake.unshift(head);

  // eat
  if(head.x===food.x && head.y===food.y){
    score++;
    document.getElementById("score").innerText=score;
    food=randomFood();

    if(speed>60) speed-=3;
  }else{
    snake.pop();
  }

  draw();
  setTimeout(update,speed);
}

function gameOver(){
  running=false;
  document.getElementById("over").style.display="flex";
  document.getElementById("final").innerText="score "+score;
}

function restart(){
  location.reload();
}

/* toetsenbord */
document.addEventListener("keydown",e=>{
  if(e.key==="ArrowUp" && dir.y!==1) dir={x:0,y:-1};
  if(e.key==="ArrowDown" && dir.y!==-1) dir={x:0,y:1};
  if(e.key==="ArrowLeft" && dir.x!==1) dir={x:-1,y:0};
  if(e.key==="ArrowRight" && dir.x!==-1) dir={x:1,y:0};
});

/* swipe mobile */
let sx,sy;
document.addEventListener("touchstart",e=>{
  sx=e.touches[0].clientX;
  sy=e.touches[0].clientY;
});

document.addEventListener("touchend",e=>{
  let dx=e.changedTouches[0].clientX-sx;
  let dy=e.changedTouches[0].clientY-sy;

  if(Math.abs(dx)>Math.abs(dy)){
    if(dx>0 && dir.x!==-1) dir={x:1,y:0};
    else if(dx<0 && dir.x!==1) dir={x:-1,y:0};
  }else{
    if(dy>0 && dir.y!==-1) dir={x:0,y:1};
    else if(dy<0 && dir.y!==1) dir={x:0,y:-1};
  }
});

draw();
update();
</script>

</body>
</html>