<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>FLAPPY DOT</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
<style>
body{margin:0;background:#000;overflow:hidden;font-family:'Press Start 2P',cursive;color:#fff}
canvas{display:block;margin:0 auto;background:#000}
a.back{position:fixed;top:14px;left:14px;font-size:10px;color:#fff;text-decoration:none;opacity:.7;z-index:10}
#hud{position:fixed;top:14px;right:14px;font-size:12px;opacity:.85;z-index:10}
</style>
</head>
<body>
<a href="../../" class="back">EXIT</a>
<div id="hud">0</div>
<canvas id="c"></canvas>
<script>
const c=document.getElementById("c");
const ctx=c.getContext("2d");
const hud=document.getElementById("hud");

function resize(){ c.width=innerWidth; c.height=innerHeight; }
addEventListener("resize",resize); resize();

let y=c.height/2, vy=0, g=0.55;
let x=120;
let pipes=[];
let score=0;
let alive=true;

function reset(){
  y=c.height/2; vy=0; pipes=[]; score=0; alive=true; hud.textContent="0";
  spawnPipe();
}
function spawnPipe(){
  const gap=180;
  const topH = Math.random()*(c.height-300)+60;
  pipes.push({x:c.width+40, top:topH, gap});
}
function tap(){
  if(!alive){ reset(); return; }
  vy=-9.5;
}
addEventListener("mousedown",tap);
addEventListener("touchstart",(e)=>{ e.preventDefault(); tap(); }, {passive:false});

let last=0;
function loop(ts){
  ctx.clearRect(0,0,c.width,c.height);

  // bird
  if(alive){
    vy+=g;
    y+=vy;
  }

  // bounds
  if(y<20) { y=20; vy=0; }
  if(y>c.height-20){
    alive=false;
  }

  // pipes
  if(alive){
    if(pipes.length===0 || pipes[pipes.length-1].x < c.width-280) spawnPipe();
    pipes.forEach(p=>p.x-=4);
  }

  // draw pipes & collisions
  ctx.fillStyle="#00ffff";
  pipes.forEach(p=>{
    // top
    ctx.fillRect(p.x,0,60,p.top);
    // bottom
    ctx.fillRect(p.x,p.top+p.gap,60,c.height-(p.top+p.gap));

    // collision
    const birdR=14;
    const bx=x, by=y;
    const inX = bx+birdR > p.x && bx-birdR < p.x+60;
    if(inX){
      const hitTop = by-birdR < p.top;
      const hitBot = by+birdR > p.top+p.gap;
      if(hitTop || hitBot) alive=false;
    }

    // score when pass
    if(alive && !p.scored && p.x+60 < x-14){
      p.scored=true;
      score++; hud.textContent=String(score);
    }
  });

  // remove old
  pipes=pipes.filter(p=>p.x>-80);

  // bird draw
  ctx.fillStyle="#ff00ff";
  ctx.beginPath();
  ctx.arc(x,y,14,0,Math.PI*2);
  ctx.fill();

  // game over
  if(!alive){
    ctx.fillStyle="rgba(0,0,0,.65)";
    ctx.fillRect(0,0,c.width,c.height);
    ctx.fillStyle="#ff0033";
    ctx.font="20px 'Press Start 2P'";
    ctx.textAlign="center";
    ctx.fillText("GAME OVER", c.width/2, c.height/2-20);
    ctx.fillStyle="#fff";
    ctx.font="12px 'Press Start 2P'";
    ctx.fillText("tap to retry", c.width/2, c.height/2+18);
  }

  requestAnimationFrame(loop);
}
reset();
requestAnimationFrame(loop);
</script>
</body>
</html>